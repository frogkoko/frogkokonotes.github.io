<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thai Vocabulary Flashcards</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://js.puter.com/v2/"></script>
    <style>* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Noto Serif Thai', serif;
}

body {
    background: white;
    color: #333333;
    min-height: 100vh;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.container {
    max-width: 800px;
    width: 100%;
    margin: 0 auto;
}

header {
    text-align: center;
    margin-bottom: 30px;
    color: #1a1a2e;
    text-shadow: none;
    position: relative;
}

.back-btn {
    position: absolute;
    left: 0;
    top: 0;
    background: rgba(0, 0, 0, 0.05);
    color: #1a1a2e;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 1.2rem;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
    text-decoration: none;
}

.back-btn:hover {
    background: rgba(0, 0, 0, 0.1);
    transform: scale(1.1);
}

h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    color: #1a1a2e;
    text-shadow: none;
}

.subtitle {
    font-size: 1.2rem;
    opacity: 0.8;
    color: #555555;
}

.card-container {
    position: relative;
    height: 400px;
    width: 100%;
    margin: 30px 0;
    display: flex;
    justify-content: center;
    align-items: center;
}

.flashcard {
    position: relative;
    height: 100%;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
}

.card-face {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 30px;
    transition: all 0.75s ease;
    transform-style: preserve-3d;
    backface-visibility: hidden;
}

.card-front {
    background: linear-gradient(135deg, #e6f0ff, #d4e6ff);
    color: #1a1a2e;
    transform: rotateY(0deg);
    border: 1px solid rgba(0, 0, 139, 0.2);
}

.flashcard.turned .card-front {
    transform: rotateY(180deg);
}

.card-back {
    background: linear-gradient(135deg, #d4e6ff, #e6f0ff);
    color: #1a1a2e;
    transform: rotateY(-180deg);
    border: 1px solid rgba(0, 0, 139, 0.2);
}

.flashcard.turned .card-back {
    transform: rotateY(0deg);
}

.thai {
    font-size: 3rem;
    font-weight: bold;
    margin-bottom: 15px;
    text-align: center;
    color: #0066cc;
    font-family: 'Noto Serif Thai', serif;
}

.english {
    font-size: 1.8rem;
    text-align: center;
    opacity: 0.9;
    color: #333333;
}

.romanized {
    font-size: 1.5rem;
    text-align: center;
    color: #0066cc;
    margin-bottom: 10px;
    font-style: italic;
}

.category {
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(0, 0, 139, 0.1);
    padding: 5px 15px;
    border-radius: 20px;
    font-size: 0.9rem;
    color: #0066cc;
}

.flip-hint {
    position: absolute;
    bottom: 20px;
    font-size: 1rem;
    color: rgba(0, 0, 139, 0.7);
    font-style: italic;
    opacity: 0.9;
}

.controls {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 30px;
    flex-wrap: wrap;
}

.control-btn {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    border: none;
    font-size: 1.8rem;
    color: white;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s, box-shadow 0.2s;
}

.control-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
}

.control-btn:active {
    transform: scale(0.95);
}

.control-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.know-btn {
    background: linear-gradient(135deg, #4caf50, #2e7d32);
}

.dont-know-btn {
    background: linear-gradient(135deg, #3f51b5, #303f9f);
}

.flip-btn {
    background: linear-gradient(135deg, #2196f3, #0b7dda);
}

.speak-btn {
    background: linear-gradient(135deg, #ff9800, #e68a00);
}

.reset-btn {
    background: linear-gradient(135deg, #e91e63, #ad1457);
}

.shuffle-btn {
    background: linear-gradient(135deg, #673ab7, #512da8);
}

.deck-selector {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.deck-btn {
    padding: 12px 25px;
    border: none;
    border-radius: 30px;
    background: rgba(0, 0, 139, 0.05);
    color: #1a1a2e;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 139, 0.2);
}

.deck-btn.active {
    background: rgba(0, 0, 139, 0.15);
    box-shadow: 0 5px 15px rgba(0, 0, 139, 0.2);
}

.progress {
    width: 100%;
    height: 10px;
    background: rgba(0, 0, 139, 0.1);
    border-radius: 5px;
    margin: 20px 0;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: linear-gradient(90deg, #2196f3, #0b7dda);
    border-radius: 5px;
    transition: width 0.5s;
}

.stats {
    display: flex;
    justify-content: space-between;
    color: #1a1a2e;
    margin-top: 10px;
    font-size: 1.1rem;
}

.instructions {
    background: rgba(230, 240, 255, 0.8);
    padding: 20px;
    border-radius: 15px;
    margin-top: 30px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    max-width: 600px;
    border: 1px solid rgba(0, 0, 139, 0.2);
}

.instructions h3 {
    color: #0066cc;
    margin-bottom: 10px;
}

.instructions p {
    color: #333333;
    margin-bottom: 10px;
    line-height: 1.5;
}

.status-message {
    text-align: center;
    color: #2196f3;
    margin-top: 10px;
    font-size: 0.9rem;
    min-height: 20px;
}

.tts-controls {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 15px;
    flex-wrap: wrap;
}

.tts-control-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}

.tts-control-group label {
    font-size: 0.9em;
    margin-bottom: 0;
    color: rgba(0, 0, 139, 0.8);
}

.tts-rate-control, .tts-pitch-control {
    display: flex;
    align-items: center;
    gap: 10px;
}

.tts-rate-control input, .tts-pitch-control input {
    width: 100px;
}

.openai-info {
    background: rgba(33, 150, 243, 0.1);
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
    font-size: 0.9em;
    text-align: center;
    border-left: 4px solid #2196f3;
    color: rgba(0, 0, 139, 0.9);
}

.word-type {
    font-size: 1.2rem;
    color: #0066cc;
    margin-bottom: 10px;
    font-weight: bold;
}

@media (max-width: 600px) {
    .thai {
        font-size: 2.5rem;
    }

    .english {
        font-size: 1.5rem;
    }

    .controls {
        gap: 15px;
    }

    .control-btn {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
    }

    .card-container {
        height: 350px;
    }
}
 </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../../index.html" class="back-btn">
                <i class="fas fa-arrow-left"></i>
            </a>
            <h1>Thai Vocabulary Study</h1>
            <p class="subtitle">Master Thai Words from Single Letters to Complete Phrases</p>
        </header>

        <div class="openai-info">
            üîä <strong>OpenAI TTS Integration:</strong> Using OpenAI's advanced text-to-speech for authentic Thai pronunciation
        </div>

        <div class="deck-selector">
            <button class="deck-btn active" data-deck="one-letter">1-Letter Words</button>
            <button class="deck-btn" data-deck="two-letter">2-Letter Words</button>
            <button class="deck-btn" data-deck="three-letter">3-Letter Words</button>
            <button class="deck-btn" data-deck="four-letter">4-Letter Words</button>
        </div>

        <div class="progress">
            <div class="progress-bar" id="progress-bar"></div>
        </div>

        <div class="stats">
            <span>Cards Left: <span id="cards-left">0</span></span>
            <span>Known: <span id="known-count">0</span></span>
        </div>

        <div class="card-container">
            <div class="flashcard" id="flashcard">
                <div class="card-face card-front">
                    <div class="category" id="front-category">1-Letter Words</div>
                    <div class="word-type" id="front-type">Thai Character</div>
                    <div class="thai" id="front-thai">‡∏Å</div>
                    <div class="flip-hint">Click to reveal details</div>
                </div>
                <div class="card-face card-back">
                    <div class="category" id="back-category">1-Letter Words</div>
                    <div class="word-type" id="back-type">Thai Character</div>
                    <div class="thai" id="back-thai">‡∏Å</div>
                    <div class="romanized" id="back-romanized">gor gai</div>
                    <div class="english" id="back-english">Chicken</div>
                    <div class="flip-hint">Click to see question</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="control-btn dont-know-btn" id="dont-know-btn" title="Don't know">
                <i class="fas fa-times"></i>
            </button>
            <button class="control-btn flip-btn" id="flip-btn" title="Flip">
                <i class="fas fa-redo"></i>
            </button>
            <button class="control-btn speak-btn" id="speak-btn" title="Speak">
                <i class="fas fa-volume-up"></i>
            </button>
            <button class="control-btn reset-btn" id="reset-btn" title="Reset">
                <i class="fas fa-sync-alt"></i>
            </button>
            <button class="control-btn shuffle-btn" id="shuffle-btn" title="Shuffle">
                <i class="fas fa-random"></i>
            </button>
            <button class="control-btn know-btn" id="know-btn" title="Know it">
                <i class="fas fa-check"></i>
            </button>
        </div>

        <div class="status-message" id="status-message"></div>

        <div class="tts-controls">
            <div class="tts-control-group">
                <label for="voiceSelector">TTS Provider:</label>
                <select id="voiceSelector" class="voice-btn">
                    <option value="openai-fable">OpenAI Fable</option>
                    <option value="browser">Browser TTS</option>
                </select>
            </div>
            <div class="tts-control-group">
                <label for="ttsRate">Speech Rate:</label>
                <div class="tts-rate-control">
                    <input type="range" id="ttsRate" min="0.5" max="2" step="0.1" value="0.8">
                    <span id="ttsRateValue">0.8</span>
                </div>
            </div>
            <div class="tts-control-group">
                <label for="ttsPitch">Speech Pitch:</label>
                <div class="tts-pitch-control">
                    <input type="range" id="ttsPitch" min="0.5" max="2" step="0.1" value="1">
                    <span id="ttsPitchValue">1.0</span>
                </div>
            </div>
        </div>

        <div class="instructions">
            <h3>How to Use</h3>
            <p><strong>Flip:</strong> Click the blue button or tap the card to see pronunciation and meaning</p>
            <p><strong>Speak:</strong> Click the orange button to hear Thai pronunciation using OpenAI TTS</p>
            <p><strong>Know it:</strong> Click the green button if you know the word</p>
            <p><strong>Don't know:</strong> Click the purple button to review the card again later</p>
            <p><strong>Reset:</strong> Click the pink button to restart the deck</p>
            <p><strong>Shuffle:</strong> Click the violet button to randomize the card order</p>
            <p><strong>Word Types:</strong> Learn Thai characters, words, and phrases from basic to advanced levels</p>
        </div>
    </div>

    <script>
        const thaiContent = {
            "one-letter": [
                { thai: '‡∏Å', romanized: 'gor gai', english: 'chicken', type: 'Consonant' },
                { thai: '‡∏Ç', romanized: 'khor khai', english: 'egg', type: 'Consonant' },
                { thai: '‡∏Ñ', romanized: 'khor khwai', english: 'buffalo', type: 'Consonant' },
                { thai: '‡∏á', romanized: 'ngor ngu', english: 'snake', type: 'Consonant' },
                { thai: '‡∏à', romanized: 'jor jan', english: 'plate', type: 'Consonant' },
                { thai: '‡∏°', romanized: 'mor ma', english: 'horse', type: 'Consonant' },
                { thai: '‡∏ô', romanized: 'nor nu', english: 'mouse', type: 'Consonant' },
                { thai: '‡∏ö', romanized: 'bor bai mai', english: 'leaf', type: 'Consonant' }
            ],
            "two-letter": [
                { thai: '‡∏Å‡∏≤', romanized: 'gaa', english: 'crow', type: 'Word' },
                { thai: '‡∏Ç‡∏≤', romanized: 'khaa', english: 'leg', type: 'Word' },
                { thai: '‡∏Ñ‡∏≤', romanized: 'khaa', english: 'stuck', type: 'Word' },
                { thai: '‡∏á‡∏≤', romanized: 'ngaa', english: 'sesame', type: 'Word' },
                { thai: '‡∏à‡∏≤', romanized: 'jaa', english: 'to say', type: 'Word' },
                { thai: '‡∏°‡∏≤', romanized: 'maa', english: 'to come', type: 'Word' },
                { thai: '‡∏ô‡∏≤', romanized: 'naa', english: 'rice field', type: 'Word' },
                { thai: '‡∏ö‡∏≤', romanized: 'baa', english: 'to carry', type: 'Word' },
                { thai: '‡∏õ‡∏≤', romanized: 'bpaa', english: 'to throw', type: 'Word' },
                { thai: '‡∏ú‡∏≤', romanized: 'paa', english: 'cliff', type: 'Word' },
                { thai: '‡∏Å‡∏¥', romanized: 'g√¨', english: 'mountain', type: 'Word' },
                { thai: '‡∏Ç‡∏µ‡πà', romanized: 'k√¨i', english: 'to ride', type: 'Word' },
                { thai: '‡∏Ñ‡∏¥', romanized: 'k√≠', english: 'eyebrow', type: 'Word' },
                { thai: '‡∏á‡∏π', romanized: 'nguu', english: 'snake', type: 'Word' },
                { thai: '‡∏à‡∏¥', romanized: 'j√¨', english: 'tiny', type: 'Word' }
            ],
            "three-letter": [
                { thai: '‡∏Å‡∏≤‡∏á', romanized: 'gaang', english: 'to open', type: 'Word' },
                { thai: '‡∏Ç‡∏≤‡∏¢', romanized: 'khaai', english: 'to sell', type: 'Word' },
                { thai: '‡∏Ñ‡∏≠‡∏¢', romanized: 'khoi', english: 'to wait', type: 'Word' },
                { thai: '‡∏á‡∏≤‡∏°', romanized: 'ngaam', english: 'beautiful', type: 'Word' },
                { thai: '‡∏à‡∏≤‡∏Å', romanized: 'jaak', english: 'from', type: 'Word' },
                { thai: '‡∏°‡∏≤‡∏ô', romanized: 'maan', english: 'to bring', type: 'Word' },
                { thai: '‡∏ô‡∏≠‡∏ô', romanized: 'nawn', english: 'to sleep', type: 'Word' },
                { thai: '‡∏ö‡∏≤‡∏ô', romanized: 'baan', english: 'blooming', type: 'Word' },
                { thai: '‡∏õ‡∏≤‡∏Å', romanized: 'bpaak', english: 'mouth', type: 'Word' },
                { thai: '‡∏ú‡∏≠‡∏°', romanized: 'paawm', english: 'thin', type: 'Word' },
                { thai: '‡∏ù‡∏ô', romanized: 'fon', english: 'rain', type: 'Word' },
                { thai: '‡∏û‡∏≤‡∏¢', romanized: 'paai', english: 'to row', type: 'Word' },
                { thai: '‡πÄ‡∏Å‡πà‡∏≤', romanized: 'g√†o', english: 'old', type: 'Word' },
                { thai: '‡∏Ç‡πâ‡∏≤‡∏ß', romanized: 'kh√¢ao', english: 'rice', type: 'Word' },
                { thai: '‡πÄ‡∏Ñ‡πâ‡∏≤', romanized: 'k√°o', english: 'he/she', type: 'Word' },
                { thai: '‡πÄ‡∏á‡∏≤', romanized: 'ngao', english: 'shadow', type: 'Word' },
                { thai: '‡πÄ‡∏à‡∏≠', romanized: 'jooi', english: 'to meet', type: 'Word' },
                { thai: '‡πÄ‡∏î‡∏µ‡∏¢‡∏ß', romanized: 'diao', english: 'only', type: 'Word' },
                { thai: '‡πÄ‡∏ó‡πà‡∏≤', romanized: 'th√¢o', english: 'equal', type: 'Word' }
            ],
            "four-letter": [
                { thai: '‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á', romanized: 'gaang-geng', english: 'pants', type: 'Phrase' },
                { thai: '‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á', romanized: 'khaai-kaawng', english: 'to sell things', type: 'Phrase' },
                { thai: '‡∏Ñ‡∏≠‡∏¢‡∏î‡∏π', romanized: 'khoi-doo', english: 'to wait and see', type: 'Phrase' },
                { thai: '‡∏á‡∏≤‡∏°‡πÅ‡∏ó‡πâ', romanized: 'ngaam-thaae', english: 'truly beautiful', type: 'Phrase' },
                { thai: '‡∏à‡∏≤‡∏Å‡πÑ‡∏õ', romanized: 'jaak-bpai', english: 'to leave', type: 'Phrase' },
                { thai: '‡∏°‡∏≤‡∏ô‡∏≤‡∏ô', romanized: 'maa-naan', english: 'for a long time', type: 'Phrase' },
                { thai: '‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö', romanized: 'nawn-lap', english: 'to sleep', type: 'Phrase' },
                { thai: '‡∏ö‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà', romanized: 'baan-yai', english: 'big bloom', type: 'Phrase' },
                { thai: '‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤', romanized: 'bpaak-gaa', english: 'pen', type: 'Phrase' },
                { thai: '‡∏ú‡∏≠‡∏°‡∏ö‡∏≤‡∏á', romanized: 'paawm-baang', english: 'slender', type: 'Phrase' },
                { thai: '‡∏ù‡∏ô‡∏ï‡∏Å', romanized: 'fon-dtok', english: 'raining', type: 'Phrase' },
                { thai: '‡∏û‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡∏≠', romanized: 'paai-reuua', english: 'to row a boat', type: 'Phrase' },
                { thai: '‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏Å‡πà', romanized: 'g√†o-g√†e', english: 'ancient', type: 'Phrase' },
                { thai: '‡∏Ç‡πâ‡∏≤‡∏ß‡∏™‡∏≤‡∏£', romanized: 'kh√¢ao-sƒÉan', english: 'uncooked rice', type: 'Phrase' },
                { thai: '‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡πÜ', romanized: 'ng√Æap-ng√Æap', english: 'quietly', type: 'Phrase' },
                { thai: '‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á', romanized: 'j√≤r-jong', english: 'specifically', type: 'Phrase' },
                { thai: '‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ô‡∏µ‡πâ', romanized: 'diao-n√≠i', english: 'now', type: 'Phrase' },
                { thai: '‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà', romanized: 'th√¢o-r√†i', english: 'how much', type: 'Phrase' },
                { thai: '‡πÄ‡∏£‡∏≤‡πÄ‡∏≠‡∏á', romanized: 'rao-eeng', english: 'ourselves', type: 'Phrase' }
            ]
        };

        let currentDeck = 'one-letter';
        let cards = [];
        let currentCardIndex = 0;
        let knownCards = 0;
        let dontKnowCards = [];
        let turned = false;
        let currentAudio = null;
        let isSpeaking = false;
        let useOpenAI = true;
        let ttsRate = 0.8;
        let ttsPitch = 1;

        const flashcard = document.getElementById('flashcard');
        const frontThai = document.getElementById('front-thai');
        const backThai = document.getElementById('back-thai');
        const backRomanized = document.getElementById('back-romanized');
        const backEnglish = document.getElementById('back-english');
        const frontCategory = document.getElementById('front-category');
        const backCategory = document.getElementById('back-category');
        const frontType = document.getElementById('front-type');
        const backType = document.getElementById('back-type');
        const progressBar = document.getElementById('progress-bar');
        const cardsLeftElement = document.getElementById('cards-left');
        const knownCountElement = document.getElementById('known-count');
        const statusMessage = document.getElementById('status-message');
        const flipBtn = document.getElementById('flip-btn');
        const knowBtn = document.getElementById('know-btn');
        const dontKnowBtn = document.getElementById('dont-know-btn');
        const resetBtn = document.getElementById('reset-btn');
        const speakBtn = document.getElementById('speak-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const deckButtons = document.querySelectorAll('.deck-btn');
        const voiceSelector = document.getElementById('voiceSelector');
        const ttsRateSlider = document.getElementById('ttsRate');
        const ttsPitchSlider = document.getElementById('ttsPitch');
        const ttsRateValue = document.getElementById('ttsRateValue');
        const ttsPitchValue = document.getElementById('ttsPitchValue');

        function init() {
            loadDeck(currentDeck);
            updateProgress();
            setupEventListeners();
        }

      function loadDeck(deckName) {
    currentDeck = deckName;
    cards = [...thaiContent[deckName]];
    dontKnowCards = [];
    currentCardIndex = 0;
    knownCards = 0;
    
    // Reset card to front face
    turned = false;
    flashcard.classList.remove('turned');
    
    updateCard();
    updateProgress();
}

function shuffleCards() {
    if (cards.length === 0) return;
    
    // Reset card to front face before shuffling
    turned = false;
    flashcard.classList.remove('turned');
    
    // Fisher-Yates shuffle algorithm
    for (let i = cards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [cards[i], cards[j]] = [cards[j], cards[i]];
    }
    
    currentCardIndex = 0;
    
    // Small delay to ensure the flip reset is complete before updating content
    setTimeout(() => {
        updateCard();
        updateStatus('Cards shuffled!', 'info');
    }, 50);
    
    shuffleBtn.style.transform = 'scale(1.2)';
    setTimeout(() => {
        shuffleBtn.style.transform = 'scale(1)';
    }, 200);
}
   function updateCard() {
    if (cards.length === 0) {
        frontThai.textContent = "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!";
        backThai.textContent = "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢!";
        backRomanized.textContent = "yin dee d√ªay!";
        backEnglish.textContent = "Congratulations! You've completed all cards!";
        frontCategory.textContent = getCategoryName(currentDeck);
        backCategory.textContent = getCategoryName(currentDeck);
        frontType.textContent = "Complete!";
        backType.textContent = "Complete!";
        return;
    }

    const card = cards[currentCardIndex];
    
    frontThai.textContent = card.thai;
    backThai.textContent = card.thai;
    backRomanized.textContent = card.romanized;
    backEnglish.textContent = card.english;
    frontCategory.textContent = getCategoryName(currentDeck);
    backCategory.textContent = getCategoryName(currentDeck);
    frontType.textContent = card.type;
    backType.textContent = card.type;
}

        function getCategoryName(deck) {
            switch(deck) {
                case 'one-letter': return '1-Letter Words';
                case 'two-letter': return '2-Letter Words';
                case 'three-letter': return '3-Letter Words';
                case 'four-letter': return '4-Letter Words';
                default: return 'Thai Vocabulary';
            }
        }

       function flipCard() {
    if (cards.length === 0) return;
    
    turned = !turned;
    if (turned) {
        flashcard.classList.add('turned');
    } else {
        flashcard.classList.remove('turned');
    }
}

        // Enhanced Text-to-Speech functionality with OpenAI integration
        const speakThai = async (text) => {
            try {
                // Cancel any ongoing speech
                speechSynthesis.cancel();
                if (currentAudio) {
                    currentAudio.pause();
                    currentAudio = null;
                }

                // Use OpenAI TTS if selected
                if (useOpenAI) {
                    updateStatus('Converting with OpenAI...', 'processing');
                    
                    try {
                        const audio = await puter.ai.txt2speech(text, {
                            provider: 'openai',
                            voice: 'fable',
                            model: 'tts-1',
                            response_format: 'mp3',
                            instructions: 'Speak in Thai with clear pronunciation and correct tones'
                        });
                        
                        currentAudio = audio;
                        await audio.play();
                        
                        // Add event listeners for better UX
                        audio.addEventListener('ended', () => {
                            updateStatus('Playback complete', '');
                            currentAudio = null;
                            isSpeaking = false;
                            speakBtn.disabled = false;
                        });
                        
                        audio.addEventListener('error', (e) => {
                            console.error('OpenAI TTS error:', e);
                            updateStatus('Error playing audio', 'error');
                            currentAudio = null;
                            isSpeaking = false;
                            speakBtn.disabled = false;
                        });
                        
                    } catch (error) {
                        console.error('OpenAI TTS failed, falling back to browser TTS:', error);
                        // Fall back to browser TTS
                        useBrowserTTS(text);
                    }
                } else {
                    // Use browser TTS
                    useBrowserTTS(text);
                }
            } catch (error) {
                console.error('Error with TTS:', error);
                isSpeaking = false;
                speakBtn.disabled = false;
            }
        };

        // Browser TTS fallback
        const useBrowserTTS = (text) => {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'th-TH'; // Thai language code
                utterance.rate = ttsRate;
                utterance.pitch = ttsPitch;
                utterance.volume = 1;
                
                // Add event listeners for better UX
                utterance.onstart = () => {
                    updateStatus('Playing audio...', '');
                };
                
                utterance.onend = () => {
                    updateStatus('Playback complete', '');
                    isSpeaking = false;
                    speakBtn.disabled = false;
                };
                
                utterance.onerror = (event) => {
                    console.error('Speech synthesis error:', event);
                    updateStatus('Error playing audio', 'error');
                    isSpeaking = false;
                    speakBtn.disabled = false;
                };
                
                speechSynthesis.speak(utterance);
            } else {
                console.log('Speech synthesis not supported');
                updateStatus('Speech synthesis not supported', 'error');
                isSpeaking = false;
                speakBtn.disabled = false;
            }
        };

        function speakCard() {
            if (cards.length === 0 || isSpeaking) return;

            const currentCard = cards[currentCardIndex];
            const textToSpeak = currentCard.thai;
            
            isSpeaking = true;
            speakBtn.disabled = true;
            
            speakBtn.style.transform = 'scale(1.2)';
            setTimeout(() => {
                speakBtn.style.transform = 'scale(1)';
            }, 200);

            speakThai(textToSpeak);
        }

        function updateStatus(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = 'status-message';
            if (type) {
                statusMessage.classList.add(type);
            }
        }

    function knowCard() {
    if (cards.length === 0) return;

    // Always reset to front face before moving to next card
    turned = false;
    flashcard.classList.remove('turned');
    
    knownCards++;
    cards.splice(currentCardIndex, 1);

    if (currentCardIndex >= cards.length) {
        currentCardIndex = 0;
    }

    // Small delay to ensure the flip reset is complete before updating content
    setTimeout(() => {
        updateCard();
        updateProgress();
    }, 50);

    knowBtn.style.transform = 'scale(1.2)';
    setTimeout(() => {
        knowBtn.style.transform = 'scale(1)';
    }, 200);
}

function dontKnowCard() {
    if (cards.length === 0) return;

    // Always reset to front face before moving to next card
    turned = false;
    flashcard.classList.remove('turned');
    
    const card = cards.splice(currentCardIndex, 1)[0];
    dontKnowCards.push(card);

    if (currentCardIndex >= cards.length) {
        currentCardIndex = 0;
    }

    // Small delay to ensure the flip reset is complete before updating content
    setTimeout(() => {
        updateCard();
        updateProgress();
    }, 50);

    dontKnowBtn.style.transform = 'scale(1.2)';
    setTimeout(() => {
        dontKnowBtn.style.transform = 'scale(1)';
    }, 200);
}


        function resetCards() {
            cards = [...thaiContent[currentDeck]];
            dontKnowCards = [];
            currentCardIndex = 0;
            knownCards = 0;
            turned = false;
            flashcard.classList.remove('turned');
            updateCard();
            updateProgress();
            
            resetBtn.style.transform = 'scale(1.2)';
            setTimeout(() => {
                resetBtn.style.transform = 'scale(1)';
            }, 200);
        }

        function updateProgress() {
            const totalCards = thaiContent[currentDeck].length;
            const remainingCards = cards.length;
            const progress = ((totalCards - remainingCards) / totalCards) * 100;

            progressBar.style.width = `${progress}%`;
            cardsLeftElement.textContent = remainingCards;
            knownCountElement.textContent = knownCards;
        }

        function setupEventListeners() {
            flipBtn.addEventListener('click', flipCard);
            knowBtn.addEventListener('click', knowCard);
            dontKnowBtn.addEventListener('click', dontKnowCard);
            resetBtn.addEventListener('click', resetCards);
            speakBtn.addEventListener('click', speakCard);
            shuffleBtn.addEventListener('click', shuffleCards);

            flashcard.addEventListener('click', flipCard);

            deckButtons.forEach(button => {
                button.addEventListener('click', () => {
                    deckButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    loadDeck(button.dataset.deck);
                });
            });

            // TTS Control Event Listeners
            voiceSelector.addEventListener('change', function() {
                useOpenAI = this.value === 'openai-fable';
                updateStatus(useOpenAI ? 
                    "Using OpenAI Fable voice for Thai pronunciation" : 
                    "Using browser TTS for Thai pronunciation", 'info');
                setTimeout(() => {
                    updateStatus('', '');
                }, 3000);
            });

            ttsRateSlider.addEventListener('input', function() {
                ttsRate = parseFloat(this.value);
                ttsRateValue.textContent = ttsRate.toFixed(1);
            });

            ttsPitchSlider.addEventListener('input', function() {
                ttsPitch = parseFloat(this.value);
                ttsPitchValue.textContent = ttsPitch.toFixed(1);
            });
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>