<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn Thai Alphabet</title>
    <style>
        :root {
            --accent1: #B31942; /* Red */
            --accent2: #0A3161; /* Blue */
            --accent3: #FFFFFF; /* White */
            --gradient: var(--accent1), var(--accent2) 70%, var(--accent3) 140%;
            
            --background-color: #0a0a0a;
            --text-color: #ffffff;
            --primary-color: var(--accent1);
            --secondary-color: #cccccc;
            --tertiary-color: #888;
            --border-color: #333;
            --card-background: rgba(26, 26, 26, 0.8);
            --nav-background: rgba(10, 10, 10, 0.9);
            --header-background: rgba(10, 10, 10, 0.9);
        }

        .light-mode {
            --background-color: #f5f5f5;
            --text-color: #000000;
            --primary-color: var(--accent1);
            --secondary-color: #333333;
            --tertiary-color: #666666;
            --border-color: #dddddd;
            --card-background: #ffffff;
            --nav-background: rgba(255, 255, 255, 0.9);
            --header-background: rgba(255, 255, 255, 0.9);
        }

        /* Back Button Styles */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--accent2);
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
            border: 2px solid var(--accent1);
        }

        .back-button:hover {
            background: var(--accent1);
            transform: translateY(-2px);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        header {
            color: white;
            padding: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .mode-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            cursor: pointer;
            font-size: 1.5rem;
            z-index: 1001;
        }

        main {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 20px;
            max-width: 1400px;
            margin: 20px auto;
            background-color: var(--card-background);
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        section {
            background-color: var(--card-background);
            padding: 25px;
            margin: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            flex: 1;
            min-width: 300px;
            border: 2px solid var(--border-color);
        }

        .alphabet-learner,
        .alphabet-drawer,
        .alphabet-table {
            border: 1px solid var(--border-color);
        }

        .alphabet-table {
            flex-basis: 100%;
            max-width: 100%;
        }

        h1,
        h2 {
            color: var(--text-color);
            text-align: center;
            margin-bottom: 20px;
        }

        .input-section,
        .output-section {
            margin-bottom: 15px;
            text-align: center;
        }

        .navigation-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        select {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            width: calc(100% - 120px);
            max-width: 200px;
            margin-right: 10px;
            margin-bottom: 10px;
            background-color: var(--card-background);
            color: var(--text-color);
        }

        button {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            border: 1px solid var(--accent2);
        }

        button:hover {
            opacity: 0.9;
        }

        button:disabled {
            background-color: var(--tertiary-color);
            cursor: not-allowed;
        }

        .next-button {
            background-color: var(--accent2);
        }

        .next-button:hover {
            background-color: #1a4a8a;
        }

        .prev-button {
            background-color: var(--accent1);
        }

        .prev-button:hover {
            background-color: #d42a5a;
        }

        #thaiOutput {
            font-size: 3em;
            font-weight: bold;
            color: var(--primary-color);
            display: block;
            margin-top: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px;
            border-radius: 5px;
            position: relative;
            font-family: 'Noto Serif Thai', serif;
        }

        #thaiOutput:hover {
            background-color: rgba(179, 25, 66, 0.1);
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(179, 25, 66, 0.3);
        }

        #thaiOutput::after {
            content: 'üîä';
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.5em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        #thaiOutput:hover::after {
            opacity: 1;
        }

        #pronunciationOutput {
            font-size: 1.5em;
            color: var(--tertiary-color);
            font-style: italic;
        }

        .system-note {
            font-size: 0.9em;
            color: var(--tertiary-color);
            margin-top: 10px;
        }

        .alphabet-drawer {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #drawingCanvas {
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            background-color: white;
            cursor: crosshair;
            margin-top: 15px;
        }

        .canvas-controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        .canvas-controls label {
            margin-bottom: 0;
            display: inline-block;
        }

        .canvas-controls input[type="color"],
        .canvas-controls input[type="range"] {
            padding: 5px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .alphabet-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .alphabet-table th,
        .alphabet-table td {
            border: 1px solid var(--border-color);
            padding: 8px;
            text-align: center;
        }

        .alphabet-table th {
            background-color: var(--nav-background);
            font-weight: bold;
        }

        .alphabet-table tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .light-mode .alphabet-table tr:nth-child(even) {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .alphabet-table tr:hover {
            background-color: rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }

        .light-mode .alphabet-table tr:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .thai-text {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 5px;
            border-radius: 3px;
            position: relative;
            font-family: 'Noto Serif Thai', serif;
        }

        .thai-text:hover {
            background-color: rgba(179, 25, 66, 0.1);
            transform: scale(1.1);
            box-shadow: 0 2px 5px rgba(179, 25, 66, 0.3);
        }

        .thai-text::after {
            content: 'üîä';
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.7em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .thai-text:hover::after {
            opacity: 1;
        }

        .table-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            justify-content: center;
        }

        .tab-button {
            padding: 10px 20px;
            background-color: var(--nav-background);
            border: 1px solid var(--border-color);
            cursor: pointer;
            border-radius: 4px 4px 0 0;
            transition: background-color 0.3s ease;
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
            border-bottom: 1px solid var(--primary-color);
        }

        .tab-button:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .light-mode .tab-button:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .tab-button.active:hover {
            background-color: var(--primary-color);
        }

        .tts-info {
            background-color: rgba(179, 25, 66, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 0.9em;
            text-align: center;
            color: var(--primary-color);
            border: 1px solid rgba(179, 25, 66, 0.3);
        }

        .light-mode .tts-info {
            background-color: rgba(10, 49, 97, 0.1);
            color: var(--accent2);
            border: 1px solid rgba(10, 49, 97, 0.3);
        }

        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            background-color: var(--header-background);
            color: var(--text-color);
            font-size: 0.9em;
        }

        /* Section-specific color schemes */
        #consonants .section-title,
        #consonants .thai-char:hover {
            color: var(--accent1);
        }

        #vowels .section-title,
        #vowels .thai-char:hover {
            color: var(--accent2);
        }

        #tones .section-title,
        #tones .thai-char:hover {
            color: #000000;
        }

        .light-mode #tones .section-title,
        .light-mode #tones .thai-char:hover {
            color: #333333;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            main {
                flex-direction: column;
                padding: 10px;
            }

            section {
                margin: 10px 0;
            }

            select {
                width: calc(100% - 100px);
            }

            .navigation-buttons {
                flex-direction: column;
                align-items: center;
            }

            .alphabet-table {
                font-size: 0.9em;
            }

            .table-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .back-button {
                top: 10px;
                left: 10px;
                padding: 8px 16px;
                font-size: 0.9rem;
            }
            
            #thaiOutput {
                font-size: 2.5em;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Thai:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Back Button -->
    <a href="../../index.html" class="back-button">‚Üê Back</a>
    
    <header>
        <h1>Learn and Write Thai Alphabet</h1>
        <div class="mode-toggle" onclick="toggleMode()">
            <span>üåô</span>
        </div>
    </header>

    <main>
        <section class="alphabet-learner">
            <h2>Thai Alphabet Learner</h2>
            <div class="tts-info">
                üí° Click on Thai text to hear pronunciation!
            </div>
             <div class="input-section">
                <label for="alphabetTypeSelect">Alphabet Type:</label>
                <select id="alphabetTypeSelect">
                    <option value="consonants">Consonants</option>
                    <option value="vowels">Vowels</option>
                    <option value="tones">Tones</option>
                </select>
                <button id="randomButton">Random Character</button>
            </div>
            <div class="navigation-buttons">
                <button id="prevButton" class="prev-button">‚Üê Previous</button>
                <button id="nextButton" class="next-button">Next ‚Üí</button>
            </div>
             <div class="output-section">
                <h3>Thai Character: <span id="thaiOutput" title="Click to hear pronunciation">‡∏Å</span></h3>
                <p>Pronunciation: <span id="pronunciationOutput">gor gai</span></p>
                <p>Meaning: <span id="meaningOutput">chicken</span></p>
                <p class="system-note" id="systemNote"></p>
            </div>
        </section>

        <section class="alphabet-drawer">
            <h2>Practice Writing Thai</h2>
            <canvas id="drawingCanvas" width="400" height="400"></canvas>
            <div class="canvas-controls">
                <button id="clearCanvas">Clear Canvas</button>
                <label for="brushColor">Brush Color:</label>
                <input type="color" id="brushColor" value="#000000">
                <label for="brushSize">Brush Size:</label>
                <input type="range" id="brushSize" min="1" max="10" value="3">
            </div>
        </section>

        <section class="alphabet-table">
            <h2>Thai Alphabet Reference</h2>
            <div class="tts-info">
                üéµ Click on Thai characters in the table to hear their pronunciation!
            </div>
            <div class="table-tabs">
                <button class="tab-button active" id="consonantsTab">Consonants</button>
                <button class="tab-button" id="vowelsTab">Vowels</button>
                <button class="tab-button" id="tonesTab">Tones</button>
            </div>
            <div class="table-container">
                <table class="alphabet-table" id="alphabetTable">
                    <!-- Table content will be populated by JavaScript -->
                </table>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const alphabetTypeSelect = document.getElementById('alphabetTypeSelect');
            const randomButton = document.getElementById('randomButton');
            const prevButton = document.getElementById('prevButton');
            const nextButton = document.getElementById('nextButton');
            const thaiOutput = document.getElementById('thaiOutput');
            const pronunciationOutput = document.getElementById('pronunciationOutput');
            const meaningOutput = document.getElementById('meaningOutput');
            const systemNote = document.getElementById('systemNote');
            const consonantsTab = document.getElementById('consonantsTab');
            const vowelsTab = document.getElementById('vowelsTab');
            const tonesTab = document.getElementById('tonesTab');
            const alphabetTable = document.getElementById('alphabetTable');

            const canvas = document.getElementById('drawingCanvas');
            const ctx = canvas.getContext('2d');
            const clearCanvasBtn = document.getElementById('clearCanvas');
            const brushColorPicker = document.getElementById('brushColor');
            const brushSizeSlider = document.getElementById('brushSize');

            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;
            let currentIndex = 0;
            let currentType = 'consonants';
            let currentAudio = null;

            // Thai Alphabet Data with audio file mappings
            const thaiAlphabet = {
                consonants: [
                    { char: "‡∏Å", name: "gor gai", pronunciation: "g", meaning: "chicken", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/gor-gai-thai.mp3" },
                    { char: "‡∏Ç", name: "khor khai", pronunciation: "kh", meaning: "egg", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/khor-khai-thai.mp3" },
                    { char: "‡∏É", name: "khor khuat", pronunciation: "kh", meaning: "bottle", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/khor-khuat-thai.mp3" },
                    { char: "‡∏Ñ", name: "khor khwai", pronunciation: "kh", meaning: "buffalo", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/khor-khwai-thai.mp3" },
                    { char: "‡∏Ö", name: "khor khon", pronunciation: "kh", meaning: "person", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/khor-khon-thai.mp3" },
                    { char: "‡∏Ü", name: "khor ra-khang", pronunciation: "kh", meaning: "bell", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/khor-ra-khang-thai.mp3" },
                    { char: "‡∏á", name: "ngor ngu", pronunciation: "ng", meaning: "snake", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/ngor-ngu-thai.mp3" },
                    { char: "‡∏à", name: "jor jan", pronunciation: "j", meaning: "plate", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/jor-jan-thai.mp3" },
                    { char: "‡∏â", name: "chor ching", pronunciation: "ch", meaning: "cymbal", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/chor-ching-thai.mp3" },
                    { char: "‡∏ä", name: "chor chang", pronunciation: "ch", meaning: "elephant", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/chor-chang-thai.mp3" },
                    { char: "‡∏ã", name: "sor so", pronunciation: "s", meaning: "chain", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sor-so-thai.mp3" },
                    { char: "‡∏å", name: "chor cher", pronunciation: "ch", meaning: "tree", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/chor-cher-thai.mp3" },
                    { char: "‡∏ç", name: "yor ying", pronunciation: "y", meaning: "woman", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/yor-ying-thai.mp3" },
                    { char: "‡∏é", name: "dor chada", pronunciation: "d", meaning: "headdress", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/dor-chada-thai.mp3" },
                    { char: "‡∏è", name: "tor patak", pronunciation: "t", meaning: "goad", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/tor-patak-thai.mp3" },
                    { char: "‡∏ê", name: "thor than", pronunciation: "th", meaning: "base", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/thor-than-thai.mp3" },
                    { char: "‡∏ë", name: "thor montho", pronunciation: "th", meaning: "Montho", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/thor-montho-thai.mp3" },
                    { char: "‡∏í", name: "thor phu-thao", pronunciation: "th", meaning: "elder", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/thor-phu-thao-thai.mp3" },
                    { char: "‡∏ì", name: "nor nen", pronunciation: "n", meaning: "novice monk", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/nor-nen-thai.mp3" },
                    { char: "‡∏î", name: "dor dek", pronunciation: "d", meaning: "child", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/dor-dek-thai.mp3" },
                    { char: "‡∏ï", name: "tor tao", pronunciation: "t", meaning: "turtle", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/tor-tao-thai.mp3" },
                    { char: "‡∏ñ", name: "thor thung", pronunciation: "th", meaning: "sack", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/thor-thung-thai.mp3" },
                    { char: "‡∏ó", name: "thor thahan", pronunciation: "th", meaning: "soldier", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/thor-thahan-thai.mp3" },
                    { char: "‡∏ò", name: "thor thong", pronunciation: "th", meaning: "flag", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/thor-thong-thai.mp3" },
                    { char: "‡∏ô", name: "nor nu", pronunciation: "n", meaning: "mouse", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/nor-nu-thai.mp3" },
                    { char: "‡∏ö", name: "bor baimai", pronunciation: "b", meaning: "leaf", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/bor-baimai-thai.mp3" },
                    { char: "‡∏õ", name: "por pla", pronunciation: "p", meaning: "fish", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/por-pla-thai.mp3" },
                    { char: "‡∏ú", name: "phor phueng", pronunciation: "ph", meaning: "bee", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/phor-phueng-thai.mp3" },
                    { char: "‡∏ù", name: "for fa", pronunciation: "f", meaning: "lid", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/for-fa-thai.mp3" },
                    { char: "‡∏û", name: "phor phan", pronunciation: "ph", meaning: "tray", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/phor-phan-thai.mp3" },
                    { char: "‡∏ü", name: "for fan", pronunciation: "f", meaning: "teeth", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/for-fan-thai.mp3" },
                    { char: "‡∏†", name: "phor sam-phao", pronunciation: "ph", meaning: "junk", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/phor-sam-phao-thai.mp3" },
                    { char: "‡∏°", name: "mor ma", pronunciation: "m", meaning: "horse", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/mor-ma-thai.mp3" },
                    { char: "‡∏¢", name: "yor yak", pronunciation: "y", meaning: "giant", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/yor-yak-thai.mp3" },
                    { char: "‡∏£", name: "ror ruea", pronunciation: "r", meaning: "boat", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/ror-ruea-thai.mp3" },
                    { char: "‡∏•", name: "lor ling", pronunciation: "l", meaning: "monkey", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/lor-ling-thai.mp3" },
                    { char: "‡∏ß", name: "wor waen", pronunciation: "w", meaning: "ring", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/wor-waen-thai.mp3" },
                    { char: "‡∏®", name: "sor sala", pronunciation: "s", meaning: "pavilion", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sor-sala-thai.mp3" },
                    { char: "‡∏©", name: "sor ruesi", pronunciation: "s", meaning: "hermit", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sor-ruesi-thai.mp3" },
                    { char: "‡∏™", name: "sor sua", pronunciation: "s", meaning: "tiger", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sor-sua-thai.mp3" },
                    { char: "‡∏´", name: "hor hip", pronunciation: "h", meaning: "chest", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/hor-hip-thai.mp3" },
                    { char: "‡∏¨", name: "lor chula", pronunciation: "l", meaning: "kite", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/lor-chula-thai.mp3" },
                    { char: "‡∏≠", name: "or ang", pronunciation: "", meaning: "basin", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/or-ang-thai.mp3" },
                    { char: "‡∏Æ", name: "hor nok-huk", pronunciation: "h", meaning: "owl", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/hor-nok-huk-thai.mp3" }
                ],
                vowels: [
                    { char: "‡∏∞", name: "sara a", pronunciation: "a", meaning: "short a", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-a-thai.mp3" },
                    { char: "‡∏≤", name: "sara aa", pronunciation: "aa", meaning: "long a", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-aa-thai.mp3" },
                    { char: "‡∏¥", name: "sara i", pronunciation: "i", meaning: "short i", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-i-thai.mp3" },
                    { char: "‡∏µ", name: "sara ii", pronunciation: "ii", meaning: "long i", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-ii-thai.mp3" },
                    { char: "‡∏∂", name: "sara ue", pronunciation: "ue", meaning: "short ue", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-ue-thai.mp3" },
                    { char: "‡∏∑", name: "sara uue", pronunciation: "uue", meaning: "long uue", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-uue-thai.mp3" },
                    { char: "‡∏∏", name: "sara u", pronunciation: "u", meaning: "short u", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-u-thai.mp3" },
                    { char: "‡∏π", name: "sara uu", pronunciation: "uu", meaning: "long u", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-uu-thai.mp3" },
                    { char: "‡πÄ", name: "sara e", pronunciation: "e", meaning: "e", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-e-thai.mp3" },
                    { char: "‡πÅ", name: "sara ae", pronunciation: "ae", meaning: "ae", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-ae-thai.mp3" },
                    { char: "‡πÇ", name: "sara o", pronunciation: "o", meaning: "o", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-o-thai.mp3" },
                    { char: "‡πÉ", name: "sara ai maimuan", pronunciation: "ai", meaning: "ai", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-ai-maimuan-thai.mp3" },
                    { char: "‡πÑ", name: "sara ai maimalai", pronunciation: "ai", meaning: "ai", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/sara-ai-maimalai-thai.mp3" },
                    { char: "‡∏§", name: "rue", pronunciation: "rue", meaning: "rue", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/rue-thai.mp3" },
                    { char: "‡∏§‡πÖ", name: "rue", pronunciation: "rue", meaning: "rue", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/rue-thai.mp3" }
                ],
                tones: [
                    { char: "‡πà", name: "mai ek", pronunciation: "low tone", meaning: "first tone mark", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/mai-ek-thai.mp3" },
                    { char: "‡πâ", name: "mai tho", pronunciation: "falling tone", meaning: "second tone mark", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/mai-tho-thai.mp3" },
                    { char: "‡πä", name: "mai tri", pronunciation: "high tone", meaning: "third tone mark", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/mai-tri-thai.mp3" },
                    { char: "‡πã", name: "mai chattawa", pronunciation: "rising tone", meaning: "fourth tone mark", audio: "https://raw.githubusercontent.com/frogkoko/thai-audio/main/alphabet/mai-chattawa-thai.mp3" }
                ]
            };

            // Audio playback functionality
            const playThaiAudio = async (audioUrl) => {
                try {
                    // Stop any currently playing audio
                    if (currentAudio) {
                        currentAudio.pause();
                        currentAudio = null;
                    }
                    
                    // Create and play new audio
                    currentAudio = new Audio(audioUrl);
                    await currentAudio.play();
                    
                    // Reset when audio finishes
                    currentAudio.addEventListener('ended', () => {
                        currentAudio = null;
                    });
                    
                    currentAudio.addEventListener('error', (e) => {
                        console.error('Audio playback error:', e);
                        currentAudio = null;
                    });
                    
                } catch (error) {
                    console.error('Error playing audio:', error);
                    currentAudio = null;
                }
            };

            const displayCharacter = () => {
                const characters = thaiAlphabet[currentType];
                if (characters && characters[currentIndex]) {
                    const character = characters[currentIndex];
                    thaiOutput.textContent = character.char;
                    pronunciationOutput.textContent = character.name;
                    meaningOutput.textContent = character.meaning;
                    
                    // Store the thai data for audio
                    thaiOutput.dataset.thai = character.char;
                    thaiOutput.dataset.audio = character.audio;
                    
                    updateNavigationButtons();
                }
            };

            const updateNavigationButtons = () => {
                const characters = thaiAlphabet[currentType];
                if (characters) {
                    prevButton.disabled = currentIndex <= 0;
                    nextButton.disabled = currentIndex >= characters.length - 1;
                }
            };

            const navigateCharacter = (direction) => {
                const characters = thaiAlphabet[currentType];
                if (characters) {
                    let newIndex = currentIndex + direction;
                    
                    if (newIndex < 0) newIndex = 0;
                    if (newIndex >= characters.length) newIndex = characters.length - 1;
                    
                    currentIndex = newIndex;
                    displayCharacter();
                    
                    // Clear the canvas when navigating to a new character
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            };

            const selectRandomCharacter = () => {
                const characters = thaiAlphabet[currentType];
                if (characters) {
                    currentIndex = Math.floor(Math.random() * characters.length);
                    displayCharacter();
                    
                    // Clear the canvas when selecting a new character
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            };

            const populateTable = (type) => {
                const characters = thaiAlphabet[type];
                if (!characters) return;
                
                let tableHTML = `
                    <thead>
                        <tr>
                            <th>Character</th>
                            <th>Name</th>
                            <th>Pronunciation</th>
                            <th>Meaning</th>
                        </tr>
                    </thead>
                    <tbody>
                `;
                
                characters.forEach((char, index) => {
                    tableHTML += `
                        <tr onclick="selectCharacterFromTable('${type}', ${index})" data-type="${type}" data-index="${index}">
                            <td class="thai-text"
                                onclick="event.stopPropagation(); playThaiAudioFromTable('${char.audio}')"
                                title="Click to hear pronunciation"
                                data-thai="${char.char}"
                                data-audio="${char.audio}">
                                ${char.char}
                            </td>
                            <td>${char.name}</td>
                            <td>${char.pronunciation}</td>
                            <td>${char.meaning}</td>
                        </tr>
                    `;
                });
                
                tableHTML += '</tbody>';
                alphabetTable.innerHTML = tableHTML;
            };

            const switchTab = (type) => {
                if (type === 'consonants') {
                    consonantsTab.classList.add('active');
                    vowelsTab.classList.remove('active');
                    tonesTab.classList.remove('active');
                } else if (type === 'vowels') {
                    vowelsTab.classList.add('active');
                    consonantsTab.classList.remove('active');
                    tonesTab.classList.remove('active');
                } else if (type === 'tones') {
                    tonesTab.classList.add('active');
                    consonantsTab.classList.remove('active');
                    vowelsTab.classList.remove('active');
                }
                populateTable(type);
            };

            // Make functions globally available
            window.selectCharacterFromTable = (type, index) => {
                currentType = type;
                currentIndex = index;
                alphabetTypeSelect.value = type;
                displayCharacter();
                
                // Scroll back to converter section on mobile
                if (window.innerWidth <= 768) {
                    document.querySelector('.alphabet-learner').scrollIntoView({ behavior: 'smooth' });
                }
            };

            window.playThaiAudioFromTable = (audioUrl) => {
                playThaiAudio(audioUrl);
            };

            // Event listeners
            randomButton.addEventListener('click', selectRandomCharacter);
            nextButton.addEventListener('click', () => navigateCharacter(1));
            prevButton.addEventListener('click', () => navigateCharacter(-1));
            
            // Add audio functionality to Thai output
            thaiOutput.addEventListener('click', () => {
                const audioUrl = thaiOutput.dataset.audio;
                if (audioUrl) {
                    playThaiAudio(audioUrl);
                }
            });

            // Remove hover functionality since we're using click only now
            alphabetTypeSelect.addEventListener('change', () => {
                currentType = alphabetTypeSelect.value;
                currentIndex = 0;
                displayCharacter();
                switchTab(currentType);
            });

            consonantsTab.addEventListener('click', () => switchTab('consonants'));
            vowelsTab.addEventListener('click', () => switchTab('vowels'));
            tonesTab.addEventListener('click', () => switchTab('tones'));

            // Initial setup
            displayCharacter();
            populateTable('consonants');

            // Canvas Drawing Logic
            ctx.lineWidth = brushSizeSlider.value;
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
            ctx.strokeStyle = brushColorPicker.value;

            function getEventPos(e) {
                const rect = canvas.getBoundingClientRect();
                const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                return {
                    x: clientX - rect.left,
                    y: clientY - rect.top
                };
            }

            function draw(e) {
                if (!isDrawing) return;
                const pos = getEventPos(e);
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(pos.x, pos.y);
                ctx.stroke();
                [lastX, lastY] = [pos.x, pos.y];
            }

            function startDrawing(e) {
                e.preventDefault(); // Prevent scrolling on mobile
                isDrawing = true;
                const pos = getEventPos(e);
                [lastX, lastY] = [pos.x, pos.y];
            }

            function stopDrawing(e) {
                if (e) e.preventDefault(); // Prevent scrolling on mobile
                isDrawing = false;
            }

            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Touch events for mobile
            canvas.addEventListener('touchstart', startDrawing, { passive: false });
            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault(); // Prevent scrolling while drawing
                draw(e);
            }, { passive: false });
            canvas.addEventListener('touchend', stopDrawing, { passive: false });
            canvas.addEventListener('touchcancel', stopDrawing, { passive: false });

            clearCanvasBtn.addEventListener('click', () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            });

            brushColorPicker.addEventListener('change', (e) => {
                ctx.strokeStyle = e.target.value;
            });

            brushSizeSlider.addEventListener('input', (e) => {
                ctx.lineWidth = e.target.value;
            });
        });

        function toggleMode() {
            const body = document.body;
            body.classList.toggle('light-mode');
            const modeToggle = document.querySelector('.mode-toggle span');

            if (body.classList.contains('light-mode')) {
                modeToggle.textContent = '‚òÄÔ∏è';
                localStorage.setItem('theme', 'light');
            } else {
                modeToggle.textContent = 'üåô';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Function to apply the saved theme
        function applySavedTheme() {
            const savedTheme = localStorage.getItem('theme');
            const body = document.body;
            const modeToggle = document.querySelector('.mode-toggle span');

            if (savedTheme === 'light') {
                body.classList.add('light-mode');
                modeToggle.textContent = '‚òÄÔ∏è';
            } else {
                body.classList.remove('light-mode');
                modeToggle.textContent = 'üåô';
            }
        }

        // Apply the saved theme when the page loads
        document.addEventListener('DOMContentLoaded', applySavedTheme);
    </script>
</body>
</html>