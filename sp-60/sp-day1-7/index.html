<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mexican Spanish Flashcards with OpenAI TTS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            min-height: 100vh;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            width: 100%;
            max-width: 800px;
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #3498db;
        }

        .header p {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 20px;
        }

        .back-button {
            background: #3498db;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .back-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .main-container {
            width: 100%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Status indicator */
        .status {
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: 500;
            width: 100%;
            max-width: 600px;
        }

        .status.processing {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status.playing {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .tts-info {
            text-align: center;
            color: #7f8c8d;
            font-size: 0.9rem;
            margin-bottom: 30px;
            font-style: italic;
            width: 100%;
            max-width: 600px;
        }

        /* Flashcard Section Styles */
        .flashcard-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0f0f0;
            width: 100%;
            max-width: 800px;
        }

        .flashcard-container {
            width: 100%;
        }

        .flashcard {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 40px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #3498db;
            position: relative;
            overflow: hidden;
        }

        .flashcard:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .flashcard.flipped {
            border-color: #2ecc71;
        }

        .flashcard-front, .flashcard-back {
            display: none;
            text-align: center;
            width: 100%;
        }

        .flashcard-front.active, .flashcard-back.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .flashcard-spanish {
            font-size: 3rem;
            font-family: 'Roboto', sans-serif;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .flashcard-spanish:hover {
            color: #e74c3c;
            transform: scale(1.05);
        }

        .flashcard-english {
            font-size: 2.5rem;
            color: #3498db;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .flashcard-pronunciation {
            font-size: 1.2rem;
            color: #7f8c8d;
            font-style: italic;
            margin-bottom: 20px;
        }

        .flashcard-details {
            font-size: 1rem;
            color: #5d6d7e;
            margin-top: 15px;
            line-height: 1.5;
        }

        .flashcard-instruction {
            text-align: center;
            color: #7f8c8d;
            margin-top: 15px;
            font-size: 0.9rem;
        }

        .flashcard-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .flashcard-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .flashcard-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .flashcard-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .flashcard-button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .flashcard-button.speech {
            background: #9b59b6;
        }

        .flashcard-button.speech:hover {
            background: #8e44ad;
        }

        .flashcard-button.flip {
            background: #2ecc71;
        }

        .flashcard-button.flip:hover {
            background: #27ae60;
        }

        .flashcard-button.prev {
            background: #f39c12;
        }

        .flashcard-button.prev:hover {
            background: #d68910;
        }

        .flashcard-button.next {
            background: #e74c3c;
        }

        .flashcard-button.next:hover {
            background: #c0392b;
        }

        .flashcard-button.settings {
            background: #7f8c8d;
        }

        .flashcard-button.settings:hover {
            background: #5d6d7e;
        }

        .flashcard-button.stop {
            background: #e74c3c;
        }

        .flashcard-button.stop:hover {
            background: #c0392b;
        }

        .flashcard-counter {
            text-align: center;
            color: #7f8c8d;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .flashcard-mode-toggle {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            flex-wrap: wrap;
        }

        .mode-option {
            background: white;
            border: 2px solid #ddd;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #7f8c8d;
        }

        .mode-option.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .mode-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .flashcard-settings {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .flashcard-settings.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
            gap: 10px;
        }

        .setting-label {
            font-weight: 600;
            color: #2c3e50;
            min-width: 150px;
        }

        .setting-control {
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: white;
            font-family: 'Poppins', sans-serif;
            min-width: 200px;
        }

        /* Category Tags */
        .category-tags {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .category-tag {
            background: white;
            border: 2px solid #3498db;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #3498db;
        }

        .category-tag:hover {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
        }

        .category-tag.active {
            background: #3498db;
            color: white;
        }

        /* TTS Settings */
        .tts-settings {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .voice-selector {
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: white;
            color: #333;
            font-family: 'Poppins', sans-serif;
            min-width: 200px;
        }

        .tts-test-button {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tts-test-button:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        .api-key-input {
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: white;
            color: #333;
            font-family: 'Poppins', sans-serif;
            min-width: 300px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }

            .flashcard {
                padding: 20px;
                min-height: 250px;
            }

            .flashcard-spanish {
                font-size: 2.2rem;
            }

            .flashcard-english {
                font-size: 1.8rem;
            }

            .flashcard-controls {
                flex-direction: column;
            }

            .flashcard-button {
                width: 100%;
                justify-content: center;
            }

            .flashcard-nav {
                width: 100%;
            }

            .setting-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .setting-control {
                width: 100%;
            }
        }

        @media (max-width: 576px) {
            .header h1 {
                font-size: 2rem;
            }

            .flashcard-spanish {
                font-size: 1.8rem;
            }

            .flashcard-english {
                font-size: 1.5rem;
            }

            .flashcard-pronunciation {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <a href="../../index.html" class="back-button">‚Üê Back to Main</a>
            <h1>Mexican Spanish Flashcards with OpenAI TTS</h1>
            <p>Learn authentic Mexican and South American Spanish phrases, slang, and cultural expressions</p>
            <p>Click on Spanish text to hear pronunciation with authentic Mexican accent</p>
        </div>

        <div id="status" class="status success">Ready for text-to-speech</div>
        <p class="tts-info">Click on any Spanish text to hear its pronunciation using OpenAI TTS with Mexican accent</p>

        <div class="tts-settings" id="tts-settings">
            <span class="setting-label">TTS Provider:</span>
            <select class="voice-selector" id="tts-provider">
                <option value="openai">OpenAI</option>
            </select>
            
            <span class="setting-label">Voice:</span>
            <select class="voice-selector" id="voice-selector">
                <option value="onyx">Onyx (Recommended for Mexican Spanish)</option>
                <option value="nova">Nova (Female Mexican accent)</option>
                <option value="alloy">Alloy</option>
                <option value="echo">Echo</option>
                <option value="fable">Fable</option>
                <option value="shimmer">Shimmer</option>
            </select>
            
            <span class="setting-label">Model:</span>
            <select class="voice-selector" id="model-select">
                <option value="gpt-4o-mini-tts">gpt-4o-mini-tts</option>
                <option value="tts-1">tts-1</option>
                <option value="tts-1-hd">tts-1-hd</option>
            </select>
            
            <button class="tts-test-button" id="test-tts-button">
                üîä Test TTS
            </button>
        </div>

        <div class="category-tags" id="category-tags">
            <div class="category-tag active" data-category="all">All Cards</div>
            <div class="category-tag" data-category="greetings">Greetings & Slang</div>
            <div class="category-tag" data-category="food">Food & Drinks</div>
            <div class="category-tag" data-category="street">Street Spanish</div>
            <div class="category-tag" data-category="family">Family & Friends</div>
            <div class="category-tag" data-category="market">Market & Shopping</div>
            <div class="category-tag" data-category="expressions">Common Expressions</div>
            <div class="category-tag" data-category="transport">Transport & Directions</div>
        </div>

        <div class="flashcard-section">
            <div class="flashcard-mode-toggle">
                <div class="mode-option active" data-mode="english-first">English First</div>
                <div class="mode-option" data-mode="spanish-first">Spanish First</div>
                <div class="mode-option" data-mode="pronunciation-first">Pronunciation First</div>
            </div>
            
            <div class="flashcard-container">
                <div class="flashcard" id="current-flashcard">
                    <div class="flashcard-front active">
                        <div class="flashcard-english" id="flashcard-english">What's up? (Mexican slang)</div>
                        <div class="flashcard-instruction">Click to reveal Spanish</div>
                    </div>
                    <div class="flashcard-back">
                        <div class="flashcard-spanish" id="flashcard-spanish">¬øQu√© onda?</div>
                        <div class="flashcard-pronunciation" id="flashcard-pronunciation">keh ON-dah</div>
                        <div class="flashcard-details" id="flashcard-details">Literally "What wave?" - Very common Mexican greeting among friends</div>
                        <div class="flashcard-instruction">Click to go back</div>
                    </div>
                </div>
                
                <div class="flashcard-counter" id="flashcard-counter">Card 1 of 65</div>
                
                <div class="flashcard-controls">
                    <button class="flashcard-button speech" id="speak-button">
                        üîä Speak Spanish
                    </button>
                    <button class="flashcard-button flip" id="flip-button">
                        üîÑ Flip Card
                    </button>
                    <button class="flashcard-button stop" id="stop-button">
                        ‚èπÔ∏è Stop
                    </button>
                    <button class="flashcard-button settings" id="settings-button">
                        ‚öôÔ∏è Settings
                    </button>
                </div>
                
                <div class="flashcard-nav">
                    <button class="flashcard-button prev" id="prev-button">
                        ‚Üê Previous
                    </button>
                    <button class="flashcard-button next" id="next-button">
                        Next ‚Üí
                    </button>
                </div>
            </div>
            
            <div class="flashcard-settings" id="flashcard-settings">
                <div class="setting-row">
                    <span class="setting-label">Flashcard Set:</span>
                    <select class="setting-control" id="flashcard-set-selector">
                        <option value="all">All Cards (65 cards)</option>
                        <option value="greetings">Greetings & Slang (12 cards)</option>
                        <option value="food">Food & Drinks (10 cards)</option>
                        <option value="street">Street Spanish (8 cards)</option>
                        <option value="family">Family & Friends (8 cards)</option>
                        <option value="market">Market & Shopping (10 cards)</option>
                        <option value="expressions">Common Expressions (9 cards)</option>
                        <option value="transport">Transport & Directions (8 cards)</option>
                    </select>
                </div>
                <div class="setting-row">
                    <span class="setting-label">Auto-play Speech:</span>
                    <select class="setting-control" id="auto-speak-selector">
                        <option value="on-flip">On Flip</option>
                        <option value="on-both">Always</option>
                        <option value="off">Off</option>
                    </select>
                </div>
                <div class="setting-row">
                    <span class="setting-label">Shuffle Cards:</span>
                    <button class="flashcard-button" id="shuffle-button" style="background: #9b59b6; padding: 8px 15px;">
                        üîÄ Shuffle Now
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://js.puter.com/v2/"></script>
    <script>
        // Mexican/South American Spanish flashcards data
        const mexicanSpanishFlashcards = {
            greetings: [
                { 
                    spanish: '¬øQu√© onda?', 
                    pronunciation: 'keh ON-dah', 
                    english: 'What\'s up? (Mexican slang)',
                    details: 'Literally "What wave?" - Very common Mexican greeting among friends'
                },
                { 
                    spanish: '¬øQu√© tal?', 
                    pronunciation: 'keh TAHL', 
                    english: 'How\'s it going?',
                    details: 'Common informal greeting throughout Latin America'
                },
                { 
                    spanish: '¬°Orale!', 
                    pronunciation: 'oh-RAH-leh', 
                    english: 'Wow!/Alright!/Let\'s go!',
                    details: 'Versatile Mexican expression showing surprise, agreement, or encouragement'
                },
                { 
                    spanish: '¬°√Åndale!', 
                    pronunciation: 'AHN-dah-leh', 
                    english: 'Come on!/Hurry up!/OK!',
                    details: 'Mexican expression urging someone to do something or showing agreement'
                },
                { 
                    spanish: '¬°Qu√© padre!', 
                    pronunciation: 'keh PAH-dreh', 
                    english: 'How cool!/Awesome!',
                    details: 'Mexican slang meaning something is great or cool'
                },
                { 
                    spanish: 'Chido/a', 
                    pronunciation: 'CHEE-doh/dah', 
                    english: 'Cool/Awesome',
                    details: 'Mexican slang for something that\'s cool or excellent'
                },
                { 
                    spanish: 'G√ºey', 
                    pronunciation: 'WEY', 
                    english: 'Dude/Bro (informal)',
                    details: 'Very common Mexican slang for "dude" or "bro" among friends'
                },
                { 
                    spanish: 'Carnal', 
                    pronunciation: 'kar-NAHL', 
                    english: 'Brother/Close friend',
                    details: 'Mexican slang meaning "brother" or very close friend'
                },
                { 
                    spanish: '¬°H√≠jole!', 
                    pronunciation: 'EE-ho-leh', 
                    english: 'Wow!/Oh my!',
                    details: 'Mexican exclamation of surprise or concern'
                },
                { 
                    spanish: 'Pura vida', 
                    pronunciation: 'POO-rah VEE-dah', 
                    english: 'Pure life/Cool/Awesome',
                    details: 'Costa Rican expression meaning everything is great'
                },
                { 
                    spanish: 'Che', 
                    pronunciation: 'CHEH', 
                    english: 'Hey/Dude (Argentinian)',
                    details: 'Argentinian slang similar to "hey" or "dude"'
                },
                { 
                    spanish: '¬°Bacan!', 
                    pronunciation: 'bah-KAHN', 
                    english: 'Cool/Awesome (South American)',
                    details: 'Used in Peru, Chile, and other South American countries'
                }
            ],
            food: [
                { 
                    spanish: 'Una torta', 
                    pronunciation: 'OO-nah TOR-tah', 
                    english: 'A Mexican sandwich',
                    details: 'Not a cake! Mexican sandwich on telera bread with various fillings'
                },
                { 
                    spanish: 'Un taco al pastor', 
                    pronunciation: 'oon TAH-koh ahl pahs-TOR', 
                    english: 'A pastor taco',
                    details: 'Mexican taco with marinated pork cooked on a vertical spit'
                },
                { 
                    spanish: 'Un elote', 
                    pronunciation: 'oon eh-LOH-teh', 
                    english: 'Mexican street corn',
                    details: 'Grilled corn on the cob with mayo, cheese, chili powder, and lime'
                },
                { 
                    spanish: 'Agua de horchata', 
                    pronunciation: 'AH-gwah deh or-CHA-tah', 
                    english: 'Rice water drink',
                    details: 'Sweet Mexican rice drink with cinnamon'
                },
                { 
                    spanish: 'Una michelada', 
                    pronunciation: 'OO-nah mee-cheh-LAH-dah', 
                    english: 'Beer cocktail',
                    details: 'Mexican beer cocktail with lime juice, chili, and spices'
                },
                { 
                    spanish: 'Un ceviche', 
                    pronunciation: 'oon seh-VEE-cheh', 
                    english: 'Raw fish cured in citrus',
                    details: 'Popular seafood dish throughout Latin America'
                },
                { 
                    spanish: 'Arepa', 
                    pronunciation: 'ah-REH-pah', 
                    english: 'Corn cake (Venezuelan/Colombian)',
                    details: 'Grilled corn cake popular in Venezuela and Colombia'
                },
                { 
                    spanish: 'Pupusas', 
                    pronunciation: 'poo-POO-sahs', 
                    english: 'Stuffed tortillas (Salvadoran)',
                    details: 'Traditional Salvadoran stuffed corn tortillas'
                },
                { 
                    spanish: '¬°Buen provecho!', 
                    pronunciation: 'bwen pro-VEH-cho', 
                    english: 'Enjoy your meal!',
                    details: 'Said to someone who is eating'
                },
                { 
                    spanish: 'La cuenta, por fa', 
                    pronunciation: 'lah KWEN-tah por FAH', 
                    english: 'The check, please (informal)',
                    details: 'Informal way to ask for the bill in Mexico'
                }
            ],
            street: [
                { 
                    spanish: 'No manches', 
                    pronunciation: 'no MAHN-ches', 
                    english: 'No way!/You\'re kidding!',
                    details: 'Mexican slang expressing disbelief or surprise'
                },
                { 
                    spanish: 'Est√° ca√±√≥n', 
                    pronunciation: 'es-TAH kah-NYON', 
                    english: 'It\'s difficult/Tough',
                    details: 'Mexican slang meaning something is very difficult'
                },
                { 
                    spanish: 'Me late', 
                    pronunciation: 'meh LAH-teh', 
                    english: 'I like it/I\'m into it',
                    details: 'Mexican slang meaning you like or are interested in something'
                },
                { 
                    spanish: 'Estar crudo', 
                    pronunciation: 'es-TAR KROO-doh', 
                    english: 'To be hungover',
                    details: 'Literally "to be raw" - Mexican slang for being hungover'
                },
                { 
                    spanish: 'Chamba', 
                    pronunciation: 'CHAHM-bah', 
                    english: 'Job/Work',
                    details: 'Mexican slang for work or job'
                },
                { 
                    spanish: 'Fierro', 
                    pronunciation: 'FYEH-rroh', 
                    english: 'Let\'s go!/Awesome! (Northern Mexico)',
                    details: 'Northern Mexican slang similar to "let\'s go" or "awesome"'
                },
                { 
                    spanish: '¬°Qu√© chivo!', 
                    pronunciation: 'keh CHEE-voh', 
                    english: 'How cool! (Central American)',
                    details: 'Central American slang meaning something is cool or awesome'
                },
                { 
                    spanish: 'Pata', 
                    pronunciation: 'PAH-tah', 
                    english: 'Friend/Buddy (Peruvian)',
                    details: 'Peruvian slang for friend or buddy'
                }
            ],
            family: [
                { 
                    spanish: 'Mi jefe', 
                    pronunciation: 'mee HEH-feh', 
                    english: 'My dad (Mexican slang)',
                    details: 'Literally "my boss" - Mexican slang for father'
                },
                { 
                    spanish: 'Mi jefa', 
                    pronunciation: 'mee HEH-fah', 
                    english: 'My mom (Mexican slang)',
                    details: 'Literally "my boss" - Mexican slang for mother'
                },
                { 
                    spanish: 'Mi viejo', 
                    pronunciation: 'mee VYEH-hoh', 
                    english: 'My old man',
                    details: 'Informal way to refer to your father in many Latin American countries'
                },
                { 
                    spanish: 'Mi vieja', 
                    pronunciation: 'mee VYEH-hah', 
                    english: 'My old lady',
                    details: 'Informal way to refer to your mother or girlfriend/wife'
                },
                { 
                    spanish: 'Compa', 
                    pronunciation: 'KOM-pah', 
                    english: 'Friend/Buddy',
                    details: 'Short for "compadre" - close friend in Mexican Spanish'
                },
                { 
                    spanish: 'Cuate', 
                    pronunciation: 'KWAH-teh', 
                    english: 'Friend/Buddy',
                    details: 'Mexican slang for friend, similar to "dude" or "buddy"'
                },
                { 
                    spanish: 'Mijo/Mija', 
                    pronunciation: 'MEE-ho/MEE-hah', 
                    english: 'My son/My daughter',
                    details: 'Contraction of "mi hijo/mi hija" - affectionate term'
                },
                { 
                    spanish: 'T√≠o/T√≠a', 
                    pronunciation: 'TEE-oh/TEE-ah', 
                    english: 'Uncle/Aunt (also slang)',
                    details: 'Also used informally to refer to friends in some contexts'
                }
            ],
            market: [
                { 
                    spanish: '¬øEn cu√°nto?', 
                    pronunciation: 'en KWAN-toh', 
                    english: 'How much? (for one item)',
                    details: 'Common way to ask price in Mexican markets'
                },
                { 
                    spanish: '¬øA c√≥mo?', 
                    pronunciation: 'ah KOH-moh', 
                    english: 'How much each?',
                    details: 'Another common way to ask price in markets'
                },
                { 
                    spanish: 'Me lo deja en...', 
                    pronunciation: 'meh loh DEH-hah en', 
                    english: 'Can you give it to me for...',
                    details: 'Polite way to start bargaining in Mexican markets'
                },
                { 
                    spanish: 'Est√° car√≠simo', 
                    pronunciation: 'es-TAH kah-REE-see-moh', 
                    english: 'It\'s very expensive',
                    details: 'Use when bargaining - say it\'s too expensive'
                },
                { 
                    spanish: 'Le doy...', 
                    pronunciation: 'leh DOY', 
                    english: 'I\'ll give you...',
                    details: 'Make a counter-offer when bargaining'
                },
                { 
                    spanish: '¬°Ganga!', 
                    pronunciation: 'GAHN-gah', 
                    english: 'Bargain!/Good deal!',
                    details: 'Say when you find something at a good price'
                },
                { 
                    spanish: 'Al por mayor', 
                    pronunciation: 'ahl por mah-YOR', 
                    english: 'Wholesale/Bulk',
                    details: 'Ask if buying in bulk for better price'
                },
                { 
                    spanish: 'Feria', 
                    pronunciation: 'FEH-ryah', 
                    english: 'Change/Small money',
                    details: 'Mexican slang for small change or cash'
                },
                { 
                    spanish: 'Lana', 
                    pronunciation: 'LAH-nah', 
                    english: 'Money (Mexican slang)',
                    details: 'Literally "wool" - Mexican slang for money'
                },
                { 
                    spanish: 'Varo', 
                    pronunciation: 'VAH-roh', 
                    english: 'Money (Mexican slang)',
                    details: 'Another Mexican slang term for money'
                }
            ],
            expressions: [
                { 
                    spanish: 'No hay pedo', 
                    pronunciation: 'no eye PEH-doh', 
                    english: 'No problem/Don\'t worry',
                    details: 'Very common Mexican slang meaning "no problem"'
                },
                { 
                    spanish: 'Me vale madre', 
                    pronunciation: 'meh VAH-leh MAH-dreh', 
                    english: 'I don\'t care at all',
                    details: 'Strong Mexican expression meaning you really don\'t care'
                },
                { 
                    spanish: 'Est√° bien ca√±√≥n', 
                    pronunciation: 'es-TAH byen kah-NYON', 
                    english: 'It\'s really difficult',
                    details: 'Mexican expression for something very challenging'
                },
                { 
                    spanish: '¬°Aguas!', 
                    pronunciation: 'AH-gwahs', 
                    english: 'Watch out!/Careful!',
                    details: 'Mexican warning similar to "watch out" or "heads up"'
                },
                { 
                    spanish: 'No te rajes', 
                    pronunciation: 'no teh RAH-hes', 
                    english: 'Don\'t back down/Don\'t chicken out',
                    details: 'Mexican encouragement to not give up'
                },
                { 
                    spanish: 'Echar la hueva', 
                    pronunciation: 'eh-CHAR lah WEH-vah', 
                    english: 'To be lazy/To slack off',
                    details: 'Mexican slang for being lazy or procrastinating'
                },
                { 
                    spanish: '¬øMande?', 
                    pronunciation: 'MAHN-deh', 
                    english: 'What did you say?/Pardon?',
                    details: 'Polite Mexican way to ask someone to repeat themselves'
                },
                { 
                    spanish: '¬°Qu√© oso!', 
                    pronunciation: 'keh OH-soh', 
                    english: 'How embarrassing!',
                    details: 'Mexican expression for embarrassing situations'
                },
                { 
                    spanish: 'Ponerse las pilas', 
                    pronunciation: 'poh-NER-seh lahs PEE-lahs', 
                    english: 'To get moving/To get to work',
                    details: 'Literally "put in your batteries" - get energized'
                }
            ],
            transport: [
                { 
                    spanish: 'Un cami√≥n', 
                    pronunciation: 'oon kah-MYON', 
                    english: 'A bus (Mexican)',
                    details: 'Mexican word for bus (not "autob√∫s")'
                },
                { 
                    spanish: 'Una combi', 
                    pronunciation: 'OO-nah KOM-bee', 
                    english: 'A minibus/van',
                    details: 'Small bus or van used for public transport in Mexico'
                },
                { 
                    spanish: 'Un colectivo', 
                    pronunciation: 'oon koh-lek-TEE-voh', 
                    english: 'A shared taxi/van',
                    details: 'Shared taxi or van following a fixed route'
                },
                { 
                    spanish: '¬øA d√≥nde va?', 
                    pronunciation: 'ah DON-deh vah', 
                    english: 'Where are you going?',
                    details: 'Ask a taxi driver where they\'re headed'
                },
                { 
                    spanish: '¬øMe lleva a...?', 
                    pronunciation: 'meh YEH-vah ah', 
                    english: 'Can you take me to...?',
                    details: 'Ask a taxi driver to take you somewhere'
                },
                { 
                    spanish: 'Por aqu√≠ nomas', 
                    pronunciation: 'por ah-KEE NOH-mahs', 
                    english: 'Right here is fine',
                    details: 'Tell the driver to stop right here'
                },
                { 
                    spanish: '¬øCu√°nto es?', 
                    pronunciation: 'KWAN-toh es', 
                    english: 'How much is it?',
                    details: 'Ask for the fare'
                },
                { 
                    spanish: 'Una estaci√≥n de metro', 
                    pronunciation: 'OO-nah es-tah-SYON deh MEH-tro', 
                    english: 'A subway station',
                    details: 'Ask for directions to the subway'
                }
            ]
        };

        // TTS System using OpenAI via Puter.ai
        class OpenAITTSSystem {
            constructor() {
                this.currentAudio = null;
                this.isSpeaking = false;
                
                this.bindEvents();
            }
            
            bindEvents() {
                const testButton = document.getElementById('test-tts-button');
                const stopButton = document.getElementById('stop-button');
                
                testButton.addEventListener('click', () => {
                    this.speakText('¬°Orale g√ºey! ¬øQu√© onda? Vamos por unos tacos al pastor.');
                });
                
                stopButton.addEventListener('click', () => {
                    this.stopSpeaking();
                });
            }
            
            async speakText(text) {
                return new Promise(async (resolve, reject) => {
                    // Stop any current speech
                    this.stopSpeaking();
                    
                    if (!text || text.trim() === '') {
                        updateStatus('No text to speak', 'error');
                        reject(new Error('No text to speak'));
                        return;
                    }
                    
                    // Clean the text
                    const cleanText = text.replace(/\[.*?\]/g, '').trim();
                    
                    updateStatus('Converting text to speech...', 'processing');
                    
                    try {
                        // Get TTS settings
                        const voice = document.getElementById('voice-selector').value;
                        const model = document.getElementById('model-select').value;
                        
                        const options = {
                            provider: 'openai',
                            voice: voice,
                            model: model,
                            response_format: 'mp3',
                            instructions: voice === 'onyx' || voice === 'nova' ? "Speak in Mexican Spanish with authentic accent and slang pronunciation" : ""
                        };
                        
                        const audio = await puter.ai.txt2speech(cleanText, options);
                        
                        updateStatus(`Playing audio with OpenAI ${voice} voice`, 'playing');
                        
                        this.currentAudio = audio;
                        this.isSpeaking = true;
                        await audio.play();
                        
                        // Reset status when audio finishes
                        audio.addEventListener('ended', () => {
                            this.isSpeaking = false;
                            this.currentAudio = null;
                            updateStatus('Speech completed. Ready for next phrase.', 'success');
                            resolve();
                        });
                        
                        audio.addEventListener('error', (e) => {
                            this.isSpeaking = false;
                            this.currentAudio = null;
                            updateStatus('Error playing audio', 'error');
                            console.error('Audio playback error:', e);
                            reject(e);
                        });
                        
                    } catch (error) {
                        this.isSpeaking = false;
                        this.currentAudio = null;
                        updateStatus(`Error: ${error.message}`, 'error');
                        console.error('TTS Error:', error);
                        reject(error);
                    }
                });
            }
            
            stopSpeaking() {
                if (this.currentAudio && this.isSpeaking) {
                    this.currentAudio.pause();
                    this.currentAudio.currentTime = 0;
                    this.isSpeaking = false;
                    this.currentAudio = null;
                    updateStatus('Speech stopped', '');
                }
            }
        }

        // Flashcard System
        class FlashcardSystem {
            constructor(ttsSystem) {
                this.currentIndex = 0;
                this.isFlipped = false;
                this.mode = 'english-first';
                this.currentSet = 'all';
                this.currentCategory = 'all';
                this.cards = this.getAllCards();
                this.isShuffled = false;
                this.autoSpeak = 'on-flip';
                this.ttsSystem = ttsSystem;
                
                this.initializeElements();
                this.bindEvents();
                this.displayCurrentCard();
            }
            
            getAllCards() {
                const allCards = [];
                
                Object.keys(mexicanSpanishFlashcards).forEach(section => {
                    mexicanSpanishFlashcards[section].forEach(card => {
                        allCards.push({
                            ...card,
                            category: section
                        });
                    });
                });
                
                return allCards;
            }
            
            getFilteredCards() {
                let filtered = [];
                
                if (this.currentCategory === 'all') {
                    if (this.currentSet === 'all') {
                        filtered = this.cards;
                    } else {
                        filtered = this.cards.filter(card => card.category === this.currentSet);
                    }
                } else {
                    filtered = this.cards.filter(card => card.category === this.currentCategory);
                }
                
                return this.isShuffled ? this.shuffleArray([...filtered]) : [...filtered];
            }
            
            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
            
            initializeElements() {
                this.flashcardElement = document.getElementById('current-flashcard');
                this.englishElement = document.getElementById('flashcard-english');
                this.spanishElement = document.getElementById('flashcard-spanish');
                this.pronunciationElement = document.getElementById('flashcard-pronunciation');
                this.detailsElement = document.getElementById('flashcard-details');
                this.counterElement = document.getElementById('flashcard-counter');
                this.settingsElement = document.getElementById('flashcard-settings');
                
                this.speakButton = document.getElementById('speak-button');
                this.flipButton = document.getElementById('flip-button');
                this.prevButton = document.getElementById('prev-button');
                this.nextButton = document.getElementById('next-button');
                this.settingsButton = document.getElementById('settings-button');
                this.shuffleButton = document.getElementById('shuffle-button');
                
                this.setSelector = document.getElementById('flashcard-set-selector');
                this.autoSpeakSelector = document.getElementById('auto-speak-selector');
                this.modeOptions = document.querySelectorAll('.mode-option');
                this.categoryTags = document.querySelectorAll('.category-tag');
            }
            
            bindEvents() {
                // Flashcard click to flip
                this.flashcardElement.addEventListener('click', () => this.flipCard());
                
                // Spanish text click for TTS
                this.spanishElement.addEventListener('click', () => this.speakCurrentCard());
                
                // Button events
                this.speakButton.addEventListener('click', () => this.speakCurrentCard());
                this.flipButton.addEventListener('click', () => this.flipCard());
                this.prevButton.addEventListener('click', () => this.previousCard());
                this.nextButton.addEventListener('click', () => this.nextCard());
                this.settingsButton.addEventListener('click', () => this.toggleSettings());
                this.shuffleButton.addEventListener('click', () => this.shuffleCards());
                
                // Settings events
                this.setSelector.addEventListener('change', (e) => this.changeSet(e.target.value));
                this.autoSpeakSelector.addEventListener('change', (e) => this.changeAutoSpeak(e.target.value));
                
                // Mode toggle events
                this.modeOptions.forEach(option => {
                    option.addEventListener('click', (e) => this.changeMode(e.target.dataset.mode));
                });
                
                // Category tag events
                this.categoryTags.forEach(tag => {
                    tag.addEventListener('click', (e) => this.changeCategory(e.target.dataset.category));
                });
            }
            
            changeMode(newMode) {
                this.mode = newMode;
                this.modeOptions.forEach(option => {
                    option.classList.toggle('active', option.dataset.mode === newMode);
                });
                this.displayCurrentCard();
            }
            
            changeCategory(category) {
                this.currentCategory = category;
                this.currentIndex = 0;
                this.isFlipped = false;
                
                // Update active category tag
                this.categoryTags.forEach(tag => {
                    tag.classList.toggle('active', tag.dataset.category === category);
                });
                
                // Update set selector if needed
                if (category !== 'all') {
                    this.setSelector.value = category;
                    this.currentSet = category;
                }
                
                this.displayCurrentCard();
            }
            
            changeSet(setName) {
                this.currentSet = setName;
                this.currentIndex = 0;
                this.isFlipped = false;
                this.displayCurrentCard();
            }
            
            changeAutoSpeak(setting) {
                this.autoSpeak = setting;
            }
            
            shuffleCards() {
                this.isShuffled = true;
                this.currentIndex = 0;
                this.isFlipped = false;
                this.displayCurrentCard();
                
                // Visual feedback for shuffle
                this.shuffleButton.textContent = '‚úì Shuffled!';
                setTimeout(() => {
                    this.shuffleButton.textContent = 'üîÄ Shuffle Now';
                }, 1000);
            }
            
            toggleSettings() {
                this.settingsElement.classList.toggle('active');
            }
            
            getCurrentCard() {
                const filteredCards = this.getFilteredCards();
                return filteredCards[this.currentIndex];
            }
            
            displayCurrentCard() {
                const card = this.getCurrentCard();
                if (!card) return;
                
                const filteredCards = this.getFilteredCards();
                const total = filteredCards.length;
                
                // Update counter
                this.counterElement.textContent = `Card ${this.currentIndex + 1} of ${total}`;
                
                // Reset flip state
                this.isFlipped = false;
                this.flashcardElement.classList.remove('flipped');
                
                // Set content based on mode
                if (this.mode === 'english-first') {
                    this.englishElement.textContent = card.english;
                    this.spanishElement.textContent = card.spanish;
                    this.pronunciationElement.textContent = card.pronunciation;
                    this.detailsElement.textContent = card.details;
                    
                    document.querySelector('.flashcard-front').classList.add('active');
                    document.querySelector('.flashcard-back').classList.remove('active');
                } else if (this.mode === 'spanish-first') {
                    this.englishElement.textContent = card.english;
                    this.spanishElement.textContent = card.spanish;
                    this.pronunciationElement.textContent = card.pronunciation;
                    this.detailsElement.textContent = card.details;
                    
                    // Show Spanish first
                    document.querySelector('.flashcard-front').classList.remove('active');
                    document.querySelector('.flashcard-back').classList.add('active');
                    this.flashcardElement.classList.add('flipped');
                    this.isFlipped = true;
                } else if (this.mode === 'pronunciation-first') {
                    this.englishElement.textContent = card.pronunciation;
                    this.spanishElement.textContent = card.spanish;
                    this.pronunciationElement.textContent = card.english;
                    this.detailsElement.textContent = card.details;
                    
                    document.querySelector('.flashcard-front').classList.add('active');
                    document.querySelector('.flashcard-back').classList.remove('active');
                }
                
                // Auto-speak if enabled
                if (this.autoSpeak === 'on-both' || 
                    (this.autoSpeak === 'on-flip' && this.isFlipped)) {
                    setTimeout(() => this.speakCurrentCard(), 300);
                }
            }
            
            flipCard() {
                this.isFlipped = !this.isFlipped;
                this.flashcardElement.classList.toggle('flipped');
                
                document.querySelector('.flashcard-front').classList.toggle('active');
                document.querySelector('.flashcard-back').classList.toggle('active');
                
                // Auto-speak if enabled
                if (this.autoSpeak === 'on-flip') {
                    setTimeout(() => this.speakCurrentCard(), 300);
                }
            }
            
            async speakCurrentCard() {
                const card = this.getCurrentCard();
                if (card && this.ttsSystem) {
                    await this.ttsSystem.speakText(card.spanish);
                }
            }
            
            nextCard() {
                const filteredCards = this.getFilteredCards();
                this.currentIndex = (this.currentIndex + 1) % filteredCards.length;
                this.isFlipped = false;
                this.displayCurrentCard();
            }
            
            previousCard() {
                const filteredCards = this.getFilteredCards();
                this.currentIndex = (this.currentIndex - 1 + filteredCards.length) % filteredCards.length;
                this.isFlipped = false;
                this.displayCurrentCard();
            }
        }

        let flashcardSystem;
        let ttsSystem;

        // Update status display
        function updateStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = 'status';
            if (type) {
                statusDiv.classList.add(type);
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Check for Puter.ai availability
            if (typeof puter === 'undefined' || !puter.ai || !puter.ai.txt2speech) {
                updateStatus('Error: Puter.ai API is not available. Please make sure you have internet connection and the script is loaded.', 'error');
                document.getElementById('speak-button').disabled = true;
                document.getElementById('test-tts-button').disabled = true;
                document.getElementById('stop-button').disabled = true;
                document.querySelectorAll('.flashcard-spanish').forEach(el => {
                    el.style.cursor = 'default';
                    el.style.color = '#95a5a6';
                    el.onclick = null;
                });
                return;
            }
            
            // Initialize TTS system with OpenAI via Puter.ai
            ttsSystem = new OpenAITTSSystem();
            
            // Initialize flashcard system with TTS
            flashcardSystem = new FlashcardSystem(ttsSystem);
            
            updateStatus('OpenAI TTS ready! Click on Spanish text to hear authentic Mexican pronunciation.', 'success');
        });
    </script>
</body>
</html>